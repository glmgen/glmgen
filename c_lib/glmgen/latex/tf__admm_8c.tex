\hypertarget{tf__admm_8c}{\section{src/tf/tf\+\_\+admm.c File Reference}
\label{tf__admm_8c}\index{src/tf/tf\+\_\+admm.\+c@{src/tf/tf\+\_\+admm.\+c}}
}


Fitting trendfiltering using the A\+D\+M\+M algorithm.  


{\ttfamily \#include \char`\"{}tf.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double $\ast$ \hyperlink{tf__admm_8c_a25ffda5658b9ded4415d2175b83edd46}{tf\+\_\+admm\+\_\+default} (double $\ast$y, int n)
\begin{DoxyCompactList}\small\item\em Default call to tf\+\_\+admm Example of how to call tf\+\_\+admm, taking only the response vector {\ttfamily and} observation size ~\newline
 as inputs. Users will likely need to adjust tf\+\_\+admm\+\_\+default for their own needs, using it as a starting template. \end{DoxyCompactList}\item 
void \hyperlink{tf__admm_8c_a4d2a9a88c443d9e0e1cedf67a202968f}{tf\+\_\+admm} (double $\ast$y, double $\ast$x, double $\ast$w, int n, int k, int family, int max\+\_\+iter, int lam\+\_\+flag, double $\ast$lambda, int nlambda, double lambda\+\_\+min\+\_\+ratio, double $\ast$beta, double $\ast$obj, int $\ast$iter, int $\ast$status, double rho, double obj\+\_\+tol, double alpha\+\_\+ls, double gamma\+\_\+ls, int max\+\_\+iter\+\_\+ls, int max\+\_\+inner\+\_\+iter, int verbose)
\begin{DoxyCompactList}\small\item\em Main wrapper for fitting a trendfilter model. Takes as input either a sequence of lambda tuning parameters, or the number of desired lambda values. In the latter case the function will also calculate a lambda sequence. The user must supply allocated memory to store the output, with the function itself returning only {\ttfamily void}. For default values, and an example of how to call the function, see the function tf\+\_\+admm\+\_\+default. \end{DoxyCompactList}\item 
void \hyperlink{tf__admm_8c_a45371289f36d4cccdeeeef6525afa897}{tf\+\_\+admm\+\_\+gauss} (double $\ast$y, double $\ast$x, double $\ast$w, int n, int k, int max\+\_\+iter, double lam, double $\ast$beta, double $\ast$alpha, double $\ast$u, double $\ast$obj, int $\ast$iter, double rho, double obj\+\_\+tol, \hyperlink{structcs__sparse}{cs} $\ast$Dkt\+Dk, int verbose)
\begin{DoxyCompactList}\small\item\em Low level fitting routine for a Gaussian trendfiltering problem. Function used by tf\+\_\+admm to fit a Gaussian A\+D\+M\+M trendfilter, or as a subproblem by tf\+\_\+admm\+\_\+glm when using logistic or poisson losses. Fits the solution for a single value of lambda. Most users will want to call tf\+\_\+admm, rather than tf\+\_\+admm\+\_\+gauss directly. \end{DoxyCompactList}\item 
void \hyperlink{tf__admm_8c_ad2615fa23d18945d30a013fbb4db01b2}{tf\+\_\+admm\+\_\+glm} (double $\ast$y, double $\ast$x, double $\ast$w, int n, int k, int max\+\_\+iter, double lam, double $\ast$beta, double $\ast$alpha, double $\ast$u, double $\ast$obj, int $\ast$iter, double rho, double obj\+\_\+tol, double alpha\+\_\+ls, double gamma\+\_\+ls, int max\+\_\+iter\+\_\+ls, int max\+\_\+inner\+\_\+iter, \hyperlink{structcs__sparse}{cs} $\ast$Dkt\+Dk, func\+\_\+\+Rto\+R b, func\+\_\+\+Rto\+R b1, func\+\_\+\+Rto\+R b2, int verbose)
\begin{DoxyCompactList}\small\item\em Low level fitting routine for non-\/\+Gaussian trendfiltering problems. Can be configured to handle arbirary losses, as it takes the link function and it first two derivaties as inputs. Fits the solution for a single value of lambda. Most users will want to call tf\+\_\+admm, rather than tf\+\_\+admm\+\_\+glm directly. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Fitting trendfiltering using the A\+D\+M\+M algorithm. 

\begin{DoxyAuthor}{Author}
Taylor Arnold, Ryan Tibshirani, Veerun Sadhanala 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014-\/12-\/23 Contains all of the functions specific to the A\+D\+M\+M algorithm implementation; allows for Gaussian, binomial, and poisson losses, as well as arbitrary sample weights. 
\end{DoxyDate}


\subsection{Function Documentation}
\hypertarget{tf__admm_8c_a4d2a9a88c443d9e0e1cedf67a202968f}{\index{tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}!tf\+\_\+admm@{tf\+\_\+admm}}
\index{tf\+\_\+admm@{tf\+\_\+admm}!tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}}
\subsubsection[{tf\+\_\+admm}]{\setlength{\rightskip}{0pt plus 5cm}void tf\+\_\+admm (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{y, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{w, }
\item[{int}]{n, }
\item[{int}]{k, }
\item[{int}]{family, }
\item[{int}]{max\+\_\+iter, }
\item[{int}]{lam\+\_\+flag, }
\item[{double $\ast$}]{lambda, }
\item[{int}]{nlambda, }
\item[{double}]{lambda\+\_\+min\+\_\+ratio, }
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{obj, }
\item[{int $\ast$}]{iter, }
\item[{int $\ast$}]{status, }
\item[{double}]{rho, }
\item[{double}]{obj\+\_\+tol, }
\item[{double}]{alpha\+\_\+ls, }
\item[{double}]{gamma\+\_\+ls, }
\item[{int}]{max\+\_\+iter\+\_\+ls, }
\item[{int}]{max\+\_\+inner\+\_\+iter, }
\item[{int}]{verbose}
\end{DoxyParamCaption}
)}}\label{tf__admm_8c_a4d2a9a88c443d9e0e1cedf67a202968f}


Main wrapper for fitting a trendfilter model. Takes as input either a sequence of lambda tuning parameters, or the number of desired lambda values. In the latter case the function will also calculate a lambda sequence. The user must supply allocated memory to store the output, with the function itself returning only {\ttfamily void}. For default values, and an example of how to call the function, see the function tf\+\_\+admm\+\_\+default. 


\begin{DoxyParams}{Parameters}
{\em y} & a vector of responses \\
\hline
{\em x} & a vector of response locations; must be ordered \\
\hline
{\em w} & a vector of sample weights \\
\hline
{\em n} & the length of y, x, and w \\
\hline
{\em k} & degree of the trendfilter; i.\+e., k=1 linear \\
\hline
{\em family} & family code for the type of fit; family=0 for O\+L\+S \\
\hline
{\em max\+\_\+iter} & maximum number of A\+D\+M\+M interations; ignored for k=0 \\
\hline
{\em lam\+\_\+flag} & 0/1 flag for whether lambda sequence needs to be estimated \\
\hline
{\em lambda} & either a sequence of lambda when lam\+\_\+flag=0, or empty allocated space if lam\+\_\+flag=1 \\
\hline
{\em nlambda} & number of lambda values; need for both lam\+\_\+flag=0 and 1 \\
\hline
{\em lambda\+\_\+min\+\_\+ratio} & minimum ratio between min and max lambda; ignored for lam\+\_\+flag=0 \\
\hline
{\em beta} & allocated space of size n$\ast$nlambda to store the output coefficents \\
\hline
{\em obj} & allocated space of size max\+\_\+iter$\ast$nlambda to store the objective \\
\hline
{\em iter} & allocated space of size nlambda to store the number of iterations \\
\hline
{\em status} & allocated space of size nlambda to store the status of each run \\
\hline
{\em rho} & tuning parameter for the A\+D\+M\+M algorithm \\
\hline
{\em obj\+\_\+tol} & stopping criteria tolerance \\
\hline
{\em alpha\+\_\+ls} & for family != 0, line search tuning parameter \\
\hline
{\em gamma\+\_\+ls} & for family != 0, line search tuning parameter \\
\hline
{\em max\+\_\+iter\+\_\+ls} & for family != 0, max number of iterations in line search \\
\hline
{\em max\+\_\+inner\+\_\+iter} & for family != 0, max number of iterations in inner A\+D\+M\+M \\
\hline
{\em verbose} & 0/1 flag for printing progress \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{tf__admm_8c_a25ffda5658b9ded4415d2175b83edd46}{tf\+\_\+admm\+\_\+default} 
\end{DoxySeeAlso}
\hypertarget{tf__admm_8c_a25ffda5658b9ded4415d2175b83edd46}{\index{tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}!tf\+\_\+admm\+\_\+default@{tf\+\_\+admm\+\_\+default}}
\index{tf\+\_\+admm\+\_\+default@{tf\+\_\+admm\+\_\+default}!tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}}
\subsubsection[{tf\+\_\+admm\+\_\+default}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ tf\+\_\+admm\+\_\+default (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{y, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{tf__admm_8c_a25ffda5658b9ded4415d2175b83edd46}


Default call to tf\+\_\+admm Example of how to call tf\+\_\+admm, taking only the response vector {\ttfamily and} observation size ~\newline
 as inputs. Users will likely need to adjust tf\+\_\+admm\+\_\+default for their own needs, using it as a starting template. 


\begin{DoxyParams}{Parameters}
{\em y} & a vector of responses \\
\hline
{\em n} & the length of y, i.\+e., the number of observations \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a pointer to beta values, a column oriented (nlambda x n) array. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The user is responsible for freeing the array pointed to by the response. 
\end{DoxyNote}
\hypertarget{tf__admm_8c_a45371289f36d4cccdeeeef6525afa897}{\index{tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}!tf\+\_\+admm\+\_\+gauss@{tf\+\_\+admm\+\_\+gauss}}
\index{tf\+\_\+admm\+\_\+gauss@{tf\+\_\+admm\+\_\+gauss}!tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}}
\subsubsection[{tf\+\_\+admm\+\_\+gauss}]{\setlength{\rightskip}{0pt plus 5cm}void tf\+\_\+admm\+\_\+gauss (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{y, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{w, }
\item[{int}]{n, }
\item[{int}]{k, }
\item[{int}]{max\+\_\+iter, }
\item[{double}]{lam, }
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{alpha, }
\item[{double $\ast$}]{u, }
\item[{double $\ast$}]{obj, }
\item[{int $\ast$}]{iter, }
\item[{double}]{rho, }
\item[{double}]{obj\+\_\+tol, }
\item[{{\bf cs} $\ast$}]{Dkt\+Dk, }
\item[{int}]{verbose}
\end{DoxyParamCaption}
)}}\label{tf__admm_8c_a45371289f36d4cccdeeeef6525afa897}


Low level fitting routine for a Gaussian trendfiltering problem. Function used by tf\+\_\+admm to fit a Gaussian A\+D\+M\+M trendfilter, or as a subproblem by tf\+\_\+admm\+\_\+glm when using logistic or poisson losses. Fits the solution for a single value of lambda. Most users will want to call tf\+\_\+admm, rather than tf\+\_\+admm\+\_\+gauss directly. 


\begin{DoxyParams}{Parameters}
{\em y} & a vector of responses \\
\hline
{\em x} & a vector of response locations; must be ordered \\
\hline
{\em w} & a vector of sample weights \\
\hline
{\em n} & the length of y, x, and w \\
\hline
{\em k} & degree of the trendfilter; i.\+e., k=1 linear \\
\hline
{\em max\+\_\+iter} & maximum number of A\+D\+M\+M interations; ignored for k=0 \\
\hline
{\em lam} & the value of lambda \\
\hline
{\em beta} & allocated space for output coefficents; must pre-\/fill as it is used in warm start \\
\hline
{\em alpha} & allocated space for A\+D\+M\+M alpha covariates; must pre-\/fill as it is used in warm start \\
\hline
{\em u} & allocated space for A\+D\+M\+M u covariates; must pre-\/fill as it is used in warm start \\
\hline
{\em obj} & allocated space to store the objective; will fill at most max\+\_\+iter elements \\
\hline
{\em iter} & allocated space to store the number of iterations; will fill just one element \\
\hline
{\em rho} & tuning parameter for the A\+D\+M\+M algorithm; set to 1 for default \\
\hline
{\em obj\+\_\+tol} & stopping criteria tolerance; set to 1e-\/10 for default \\
\hline
{\em Dkt\+Dk} & pointer to the inner product of Dkt\+Dk \\
\hline
{\em verbose} & 0/1 flag for printing progress \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{tf__admm_8c_a4d2a9a88c443d9e0e1cedf67a202968f}{tf\+\_\+admm} 
\end{DoxySeeAlso}
\hypertarget{tf__admm_8c_ad2615fa23d18945d30a013fbb4db01b2}{\index{tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}!tf\+\_\+admm\+\_\+glm@{tf\+\_\+admm\+\_\+glm}}
\index{tf\+\_\+admm\+\_\+glm@{tf\+\_\+admm\+\_\+glm}!tf\+\_\+admm.\+c@{tf\+\_\+admm.\+c}}
\subsubsection[{tf\+\_\+admm\+\_\+glm}]{\setlength{\rightskip}{0pt plus 5cm}void tf\+\_\+admm\+\_\+glm (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{y, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{w, }
\item[{int}]{n, }
\item[{int}]{k, }
\item[{int}]{max\+\_\+iter, }
\item[{double}]{lam, }
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{alpha, }
\item[{double $\ast$}]{u, }
\item[{double $\ast$}]{obj, }
\item[{int $\ast$}]{iter, }
\item[{double}]{rho, }
\item[{double}]{obj\+\_\+tol, }
\item[{double}]{alpha\+\_\+ls, }
\item[{double}]{gamma\+\_\+ls, }
\item[{int}]{max\+\_\+iter\+\_\+ls, }
\item[{int}]{max\+\_\+inner\+\_\+iter, }
\item[{{\bf cs} $\ast$}]{Dkt\+Dk, }
\item[{func\+\_\+\+Rto\+R}]{b, }
\item[{func\+\_\+\+Rto\+R}]{b1, }
\item[{func\+\_\+\+Rto\+R}]{b2, }
\item[{int}]{verbose}
\end{DoxyParamCaption}
)}}\label{tf__admm_8c_ad2615fa23d18945d30a013fbb4db01b2}


Low level fitting routine for non-\/\+Gaussian trendfiltering problems. Can be configured to handle arbirary losses, as it takes the link function and it first two derivaties as inputs. Fits the solution for a single value of lambda. Most users will want to call tf\+\_\+admm, rather than tf\+\_\+admm\+\_\+glm directly. 


\begin{DoxyParams}{Parameters}
{\em y} & a vector of responses \\
\hline
{\em x} & a vector of response locations; must be ordered \\
\hline
{\em w} & a vector of sample weights \\
\hline
{\em n} & the length of y, x, and w \\
\hline
{\em k} & degree of the trendfilter; i.\+e., k=1 linear \\
\hline
{\em max\+\_\+iter} & maximum number of A\+D\+M\+M interations; ignored for k=0 \\
\hline
{\em lam} & the value of lambda \\
\hline
{\em beta} & allocated space for output coefficents; must pre-\/fill as it is used in warm start \\
\hline
{\em alpha} & allocated space for A\+D\+M\+M alpha covariates; must pre-\/fill as it is used in warm start \\
\hline
{\em u} & allocated space for A\+D\+M\+M u covariates; must pre-\/fill as it is used in warm start \\
\hline
{\em obj} & allocated space to store the objective; will fill at most max\+\_\+iter elements \\
\hline
{\em iter} & allocated space to store the number of iterations; will fill just one element \\
\hline
{\em status} & allocated space of size nlambda to store the status of each run \\
\hline
{\em rho} & tuning parameter for the A\+D\+M\+M algorithm; set to 1 for default \\
\hline
{\em obj\+\_\+tol} & stopping criteria tolerance; set to 1e-\/10 for default \\
\hline
{\em alpha\+\_\+ls} & for family != 0, line search tuning parameter \\
\hline
{\em gamma\+\_\+ls} & for family != 0, line search tuning parameter \\
\hline
{\em max\+\_\+iter\+\_\+ls} & for family != 0, max number of iterations in line search \\
\hline
{\em max\+\_\+inner\+\_\+iter} & for family != 0, max number of iterations in inner A\+D\+M\+M \\
\hline
{\em Dkt\+Dk} & pointer to the inner product of Dkt\+Dk \\
\hline
{\em b} & the link function for a given loss \\
\hline
{\em b1} & first derivative of the link function for a given loss \\
\hline
{\em b2} & second derivative of the link function for a given loss \\
\hline
{\em verbose} & 0/1 flag for printing progress \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{tf__admm_8c_a4d2a9a88c443d9e0e1cedf67a202968f}{tf\+\_\+admm} 
\end{DoxySeeAlso}
